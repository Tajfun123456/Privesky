<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D P≈ô√≠vƒõsky - MVP Prototyp (s Widgety)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script src="https://widget.packeta.com/v6/www/js/library.js"></script>
    <script src="https://www.balikovna.cz/widget/vyber-mist-v1.js"></script>

    <style>
        /* Jednoduch√Ω styl pro 'prose' (pro textov√Ω obsah) */
        .prose {
            color: #333;
            line-height: 1.6;
        }
        .prose h3 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-top: 1.5em;
            margin-bottom: 0.5em;
        }
        .prose p {
            margin-bottom: 1.25em;
        }
        .prose ul {
            list-style-type: disc;
            padding-left: 1.5em;
            margin-bottom: 1.25em;
        }
        .prose li {
            margin-bottom: 0.5em;
        }
    </style>
</head>
<body class="bg-white">
    <div id="root"></div>

    <script type="text/babel">
// --- TYPY A ROZHRAN√ç ---
// Pozn√°mka: Vzhledem k tomu, ≈æe toto bƒõ≈æ√≠ v Babelu, pou≈æijeme `React.Component` atd.
// A typy definujeme pomoc√≠ koment√°≈ô≈Ø pro p≈ôehlednost.

/*
type ProductType = 'fox' | 'dog';

interface Product {
  id: ProductType;
  name: string;
  subtitle: string;
  price: number;
  description: string;
  images: string[];
  reviews: Review[];
  details: {
    dimensions: string;
    material: string;
    colors: string;
  };
}

interface Review {
  id: string;
  author: string;
  rating: number;
  date: string;
  text: string;
}

interface CartItem {
  id: ProductType;
  quantity: number;
}
*/

// Roz≈°√≠≈ôeno o 'confirmation' str√°nku dle MVP
/* type Page = 'home' | 'product' | 'contact' | 'cart' | 'checkout' | 'printing' | 'confirmation';

interface ShippingOption {
  id: string;
  name: string;
  price: number;
  icon: React.ReactNode;
  type: 'address' | 'pickup';
}

// *** UPRAVENO: Toto je nyn√≠ obecn√° struktura pro vr√°cen√° data z widget≈Ø ***
interface PickupPoint {
  id: string;
  name: string;
  street?: string;
  city?: string;
  zip?: string;
  // Mohou zde b√Ωt i dal≈°√≠ vlastnosti specifick√© pro widget
}

interface ShippingAddress {
  city: string;
  zip: string;
  street: string;
  number: string;
}

interface ContactDetails {
    email: string;
    phone: string;
    address: ShippingAddress | null; // M≈Ø≈æe b√Ωt null pokud je pickup
}

interface OrderConfirmation {
    orderId: string;
    contact: ContactDetails;
    order: {
        items: CartItem[];
        subtotal: number;
        shippingCost: number;
        total: number;
    };
    shippingOption: ShippingOption | undefined;
    pickupPoint: PickupPoint | undefined; // Pou≈æije novou strukturu
}

interface AppContextType {
  currentPage: Page;
  currentProduct: ProductType;
  cart: CartItem[];
  shippingOptionId: string | null;
  selectedPickupPoint: PickupPoint | null; // *** UPRAVENO: z selectedPickupPointId na objekt ***
  shippingAddress: ShippingAddress;
  toastMessage: string | null;
  orderConfirmation: OrderConfirmation | null;
  isSubmitting: boolean; // <-- NOV√ù STAV
  navigateTo: (page: Page, productId?: ProductType) => void;
  addToCart: (productId: ProductType, quantity: number) => void;
  updateCartItemQuantity: (productId: ProductType, newQuantity: number) => void;
  removeFromCart: (productId: ProductType) => void;
  clearCart: () => void;
  selectShippingOption: (optionId: string) => void;
  selectPickupPoint: (point: PickupPoint | null) => void; // *** UPRAVENO: p≈ôij√≠m√° objekt nebo null ***
  setShippingAddress: (address: Partial<ShippingAddress>) => void;
  showToast: (message: string) => void;
  clearToast: () => void;
  submitOrder: (contact: ContactDetails, order: any, shipping: any, pickup: any) => Promise<void>; // <-- UPRAVENO NA ASYNC
  totalCartItems: number;
  cartSubtotal: number;
  shippingCost: number;
  totalPrice: number;
}
*/

// --- KONSTANTY A MOCK DATA ---
const { useState, useContext, createContext, useMemo, useCallback, forwardRef } = React;

const FREE_SHIPPING_THRESHOLD = 1000;
const DEFAULT_SHIPPING_COST = 50;

// Z√°stupn√© obr√°zky
const IMAGES = {
  fox_les: "https://placehold.co/600x600/567d46/white?text=Li≈°ka+v+lese",
  fox_klice: "https://placehold.co/600x600/8c6a4f/white?text=Li≈°ka+na+kl√≠ƒç√≠ch",
  fox_batoh: "https://placehold.co/600x600/2d2d2d/white?text=Li≈°ka+na+batohu",
  dog_vanoce: "https://placehold.co/600x600/a67c00/white?text=Pes+V√°noce",
  dog_batoh: "https://placehold.co/600x600/2d2d2d/white?text=Pes+na+batohu",
  dog_dvere: "https://placehold.co/600x600/8c6a4f/white?text=Pes+u+dve≈ô√≠",
  // map_placeholder a map_active ji≈æ nejsou pot≈ôeba
  printer_image: "https://placehold.co/400x300/e0e0e0/9ca3af?text=Bambu+Lab+P1S",
  filament_image: "https://placehold.co/400x300/e0e0e0/9ca3af?text=PLA+Filamenty",
};

const PRODUCT_DATA = {
  fox: {
    id: 'fox',
    name: 'P≈ô√≠vƒõsek Li≈°ka',
    subtitle: 'Tri-Color',
    price: 59,
    description: 'Ikonick√Ω li≈°ƒç√≠ design s v√Ωrazn√Ωmi barvami, ti≈°tƒõn√Ω modern√≠ 3D technologi√≠. Lehk√Ω a detailn√≠ p≈ô√≠vƒõsek. Ide√°ln√≠ pro kl√≠ƒçe nebo batoh.',
    images: [IMAGES.fox_les, IMAGES.fox_klice, IMAGES.fox_batoh, IMAGES.fox_les],
    reviews: [
      { id: 'r1', author: 'Anna K.', rating: 5, date: '15.2.2025', text: 'Perfektn√≠ kvalita! P≈ô√≠vƒõsek je lehk√Ω, barvy jsou naprosto ≈æiv√© a detaily jsou neuvƒõ≈ôiteln√©. Nos√≠m ho na batohu u≈æ mƒõs√≠c a vypad√° st√°le jako nov√Ω.' },
      { id: 'r2', author: 'Lucie S.', rating: 4, date: '5.2.2025', text: 'Velmi roztomil√Ω design a skvƒõl√© zpracov√°n√≠. Za 59 Kƒç naprosto super!' },
      { id: 'r3', author: 'Martin V.', rating: 5, date: '1.2.2025', text: 'Jsem p≈ôekvapen√Ω kvalitou 3D tisku. Detaily jsou precizn√≠ a materi√°l je opravdu odoln√Ω.' },
    ],
    details: {
      dimensions: '6 √ó 3,5 cm',
      material: 'Vysoce odoln√Ω PLA filament',
      colors: '≈Ωlut√°, ƒçerven√°, ƒçern√°, b√≠l√°',
    },
  },
  dog: {
    id: 'dog',
    name: 'P≈ô√≠vƒõsek Pes',
    subtitle: 'Nƒõmeck√Ω ovƒç√°k',
    price: 59,
    description: 'Obl√≠ben√Ω motiv psa, ti≈°tƒõn√Ω na 3D tisk√°rnƒõ. Lehk√Ω a detailn√≠ p≈ô√≠vƒõsek. Ide√°ln√≠ pro kl√≠ƒçe nebo batoh. Skvƒõl√Ω d√°rek pro milovn√≠ky ps≈Ø.',
    images: [IMAGES.dog_vanoce, IMAGES.dog_batoh, IMAGES.dog_dvere, IMAGES.dog_vanoce],
    reviews: [
      { id: 'r4', author: 'Petr M.', rating: 5, date: '10.2.2025', text: 'Koupil jsem jako d√°rek pro dceru a byla nad≈°en√°! Materi√°l je opravdu kvalitn√≠ a odoln√Ω. Rozhodnƒõ doporuƒçuji.' },
      { id: 'r5', author: 'Jana K.', rating: 5, date: '8.2.2025', text: 'M√°m nƒõmeck√©ho ovƒç√°ka a tento p≈ô√≠vƒõsek je prostƒõ dokonal√Ω! P≈ôesnƒõ zachycuje tu podobu.' },
      { id: 'r6', author: 'Tom√°≈° B.', rating: 5, date: '3.2.2025', text: 'Super cena, super kvalita. Koupil jsem si hned dva!' },
    ],
    details: {
      dimensions: '6 √ó 3,5 cm',
      material: 'Vysoce odoln√Ω PLA filament',
      colors: 'ƒåern√°, b√≠l√°',
    },
  },
};

// --- IKONY (LUCIDE-REACT N√ÅHRADA) ---
// (Ikony z≈Øst√°vaj√≠ beze zmƒõny)

const IconTruck = ({ size = 24, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <path d="M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11"/>
    <path d="M14 9h7c.6 0 1 .4 1 1v9c0 .6-.4 1-1 1h-7l-2 2v-2z"/>
    <path d="M10 6V4c0-.6-.4-1-1-1H4c-.6 0-1 .4-1 1v2"/>
    <path d="M18 18.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"/><path d="M9 18.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"/>
  </svg>
);
const IconSearch = ({ size = 24, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/>
  </svg>
);
const IconUser = ({ size = 24, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/>
  </svg>
);
const IconShoppingBag = ({ size = 24, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/>
    <path d="M16 10a4 4 0 0 1-8 0"/>
  </svg>
);
const IconMinus = ({ size = 16, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <line x1="5" y1="12" x2="19" y2="12"/>
  </svg>
);
const IconPlus = ({ size = 16, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>
  </svg>
);
const IconTrash = ({ size = 24, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
    <line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/>
  </svg>
);
const IconPackage = ({ size = 24, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
    <polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/>
  </svg>
);
const IconHome = ({ size = 24, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/>
  </svg>
);
const IconAward = ({ size = 24, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 17 17 23 15.79 13.88"/>
  </svg>
);
const IconPrinter = ({ size = 24, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/>
    <rect x="6" y="14" width="12" height="8"/>
  </svg>
);
const IconMail = ({ size = 24, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <rect x="2" y="4" width="20" height="16" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/>
  </svg>
);
const IconSend = ({ size = 18, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/>
  </svg>
);
const IconMap = ({ size = 24, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"/><line x1="8" y1="2" x2="8" y2="18"/>
    <line x1="16" y1="6" x2="16" y2="22"/>
  </svg>
);
const IconFilter = ({ size = 16, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/>
  </svg>
);
const IconCheck = ({ size = 16, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <polyline points="20 6 9 17 4 12"/>
  </svg>
);
const IconStar = ({ size = 20, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
  </svg>
);
const IconLayers = ({ size = 24, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <polygon points="12 2 2 7 12 12 22 7 12 2"/><polyline points="2 17 12 22 22 17"/><polyline points="2 12 12 17 22 12"/>
  </svg>
);
const IconZap = ({ size = 24, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
  </svg>
);
const IconLeaf = ({ size = 24, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <path d="M11 20A7 7 0 0 1 4 13V8a5 5 0 0 1 10 0v5a7 7 0 0 1-7 7z"/><path d="M20 10a5 5 0 0 0-10 0v5a5 5 0 0 0 10 0z"/>
  </svg>
);
const IconChevronRight = ({ size = 16, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <polyline points="9 18 15 12 9 6"/>
  </svg>
);
const IconBox = ({ size = 16, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
  </svg>
);
const IconPost = ({ size = 24, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><path d="M3 9h18M12 14v-2.5M12 17v.01"/>
  </svg>
);
const IconAlza = ({ size = 24, className = "" }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" fill="#00A000"/>
  </svg>
);
const IconMapPin = ({ size = 16, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/>
  </svg>
);
const IconFacebook = ({ size = 24, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/>
  </svg>
);
const IconInstagram = ({ size = 24, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <rect x="2" y="2" width="20" height="20" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/>
    <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"/>
  </svg>
);
const IconX = ({ size = 24, className = "" }) => (
 <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <line x1="18" y1="6" x2="6" y2="18" /><line x1="6" y1="6" x2="18" y2="18" />
  </svg>
);
const IconCheckCircle = ({ size = 24, className = "" }) => (
  <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
    <polyline points="22 4 12 14.01 9 11.01"/>
  </svg>
);


// *** UPRAVENO: Odebr√°ny ostatn√≠ zp≈Øsoby dopravy ***
const SHIPPING_OPTIONS_DATA = [
  { id: 'balik_box', name: 'Bal√≠kovna do Bal√≠kovny', price: 50, icon: <React.Fragment><IconPackage /><IconBox /></React.Fragment>, type: 'pickup' },
  { id: 'zasil_box', name: 'Z√°silkovna do Z-Boxu', price: 89, icon: <React.Fragment><IconPost /><IconBox /></React.Fragment>, type: 'pickup' },
];

// *** SMAZ√ÅNO: Mock data pro v√Ωdejn√≠ m√≠sta ji≈æ nejsou pot≈ôeba ***
// const PICKUP_POINTS_DATA = [ ... ];

// --- APP CONTEXT (STATE MANAGEMENT) ---

const AppContext = createContext(undefined);

const AppProvider = ({ children }) => {
  const [currentPage, setCurrentPage] = useState('home');
  const [currentProduct, setCurrentProduct] = useState('fox');
  const [cart, setCart] = useState([]);
  const [shippingOptionId, setShippingOptionId] = useState('zasil_box'); // V√Ωchoz√≠ je Z√°silkovna
  
  // *** UPRAVENO: Zmƒõna z ID na cel√Ω objekt ***
  const [selectedPickupPoint, setSelectedPickupPoint] = useState(null);
  
  const [shippingAddress, setShippingAddressState] = useState({
    city: '',
    zip: '',
    street: '',
    number: '',
  });
  const [toastMessage, setToastMessage] = useState(null);
  
  const [orderConfirmation, setOrderConfirmation] = useState(null);
  
  // ==================================================================
  // ### KROK 3 - ZMƒöNA #1: P≈ôid√°n nov√Ω stav pro sledov√°n√≠ odes√≠l√°n√≠ ###
  // ==================================================================
  const [isSubmitting, setIsSubmitting] = useState(false);


  const showToast = (message) => {
    setToastMessage(message);
    setTimeout(() => {
      setToastMessage(null);
    }, 3000);
  };

  const clearToast = () => {
    setToastMessage(null);
  };

  const navigateTo = (page, productId = 'fox') => {
    setCurrentPage(page);
    if (page === 'product') {
      setCurrentProduct(productId);
    }
    if (page !== 'confirmation') {
      setOrderConfirmation(null);
    }
    window.scrollTo(0, 0);
  };

  const addToCart = (productId, quantity) => {
    setCart((prevCart) => {
      const existingItem = prevCart.find((item) => item.id === productId);
      if (existingItem) {
        return prevCart.map((item) =>
          item.id === productId ? { ...item, quantity: item.quantity + quantity } : item
        );
      }
      return [...prevCart, { id: productId, quantity }];
    });
    showToast(`"${PRODUCT_DATA[productId].name}" p≈ôid√°n do ko≈°√≠ku!`);
  };

  const updateCartItemQuantity = (productId, newQuantity) => {
    if (newQuantity <= 0) {
      removeFromCart(productId);
    } else {
      setCart((prevCart) =>
        prevCart.map((item) =>
          item.id === productId ? { ...item, quantity: newQuantity } : item
        )
      );
    }
  };

  const removeFromCart = (productId) => {
    setCart((prevCart) => prevCart.filter((item) => item.id !== productId));
    showToast(`"${PRODUCT_DATA[productId].name}" odebr√°n z ko≈°√≠ku.`);
  };

  const clearCart = () => {
    setCart([]);
  };

  const selectShippingOption = (optionId) => {
    setShippingOptionId(optionId);
    // *** UPRAVENO: V≈ædy resetuje vybran√© m√≠sto ***
    setSelectedPickupPoint(null);
  };

  // *** UPRAVENO: P≈ôij√≠m√° cel√Ω objekt nebo null ***
  const selectPickupPoint = (point) => {
    setSelectedPickupPoint(point);
  };

  const setShippingAddress = (address) => {
    setShippingAddressState((prev) => ({ ...prev, ...address }));
  };

  // ==================================================================
  // ### KROK 3 - ZMƒöNA #2: Cel√° funkce `submitOrder` je nahrazena ###
  // ==================================================================
  const submitOrder = async (contactDetails, orderDetails, shippingOption, pickupPoint) => {
    setIsSubmitting(true); // Zaƒç√≠n√°me odes√≠lat
    
    // Vygenerujeme ID objedn√°vky na stranƒõ klienta, abychom ho mohli hned pou≈æ√≠t
    const mockOrderId = `2025-${Math.floor(Math.random() * 1000) + 1}`;

    // P≈ôid√°me n√°zvy produkt≈Ø a ceny za kus pro jednodu≈°≈°√≠ zobrazen√≠ v e-mailu
    const itemsWithDetails = orderDetails.items.map(item => ({
        ...item,
        productName: PRODUCT_DATA[item.id].name,
        price: PRODUCT_DATA[item.id].price
    }));

    const finalOrderDetails = {
        ...orderDetails,
        orderId: mockOrderId,
        items: itemsWithDetails,
    };

    // Data, kter√° po≈°leme na na≈°i serverless funkci
    const payload = {
      contact: contactDetails,
      order: finalOrderDetails,
      shippingOption: shippingOption,
      pickupPoint: pickupPoint,
    };

    try {
      // Pou≈æijeme fetch pro odesl√°n√≠ dat na na≈°i API route
      const response = await fetch('/api/send-order-email', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(payload),
      });

      // Pokud odpovƒõƒè serveru nen√≠ v po≈ô√°dku (nap≈ô. chyba 500), vyvol√°me chybu
      if (!response.ok) {
        throw new Error('Chyba p≈ôi odes√≠l√°n√≠ objedn√°vky.');
      }

      // Pokud je v≈°e v po≈ô√°dku, vytvo≈ô√≠me potvrzen√≠ a p≈ôesmƒõrujeme
      const confirmation = {
        orderId: mockOrderId,
        contact: contactDetails,
        order: orderDetails, // Pou≈æijeme p≈Øvodn√≠ orderDetails pro zobrazen√≠
        shippingOption: shippingOption,
        pickupPoint: pickupPoint,
      };

      setOrderConfirmation(confirmation);
      clearCart();
      navigateTo('confirmation');

    } catch (error) {
      console.error("Failed to submit order:", error);
      // Zobraz√≠me u≈æivateli chybovou hl√°≈°ku
      showToast('Nastala chyba p≈ôi odes√≠l√°n√≠ objedn√°vky. Zkuste to pros√≠m znovu.');
    } finally {
        setIsSubmitting(false); // Ukonƒç√≠me odes√≠l√°n√≠ (a≈• u≈æ √∫spƒõ≈°nƒõ nebo ne)
    }
  };

  // --- Odvozen√Ω stav (Memoized) ---

  const totalCartItems = useMemo(() => {
    return cart.reduce((total, item) => total + item.quantity, 0);
  }, [cart]);

  const cartSubtotal = useMemo(() => {
    return cart.reduce((total, item) => {
      return total + PRODUCT_DATA[item.id].price * item.quantity;
    }, 0);
  }, [cart]);

  const shippingCost = useMemo(() => {
    if (cart.length === 0) return 0;
    if (cartSubtotal >= FREE_SHIPPING_THRESHOLD) return 0;
    const selectedOption = SHIPPING_OPTIONS_DATA.find(opt => opt.id === shippingOptionId);
    return selectedOption ? selectedOption.price : DEFAULT_SHIPPING_COST;
  }, [cart, cartSubtotal, shippingOptionId]);

  const totalPrice = useMemo(() => {
    return cartSubtotal + shippingCost;
  }, [cartSubtotal, shippingCost]);

  // ==================================================================
  // ### KROK 3 - ZMƒöNA #3: P≈ôid√°n `isSubmitting` do hodnoty kontextu ###
  // ==================================================================
  const value = {
    currentPage,
    currentProduct,
    cart,
    shippingOptionId,
    selectedPickupPoint,
    shippingAddress,
    toastMessage,
    orderConfirmation,
    isSubmitting, // <-- P≈òID√ÅNO ZDE
    navigateTo,
    addToCart,
    updateCartItemQuantity,
    removeFromCart,
    clearCart,
    selectShippingOption,
    selectPickupPoint,
    setShippingAddress,
    showToast,
    clearToast,
    submitOrder,
    totalCartItems,
    cartSubtotal,
    shippingCost,
    totalPrice,
  };

  return <AppContext.Provider value={value}>{children}</AppContext.Provider>;
};

const useAppContext = () => {
  const context = useContext(AppContext);
  if (context === undefined) {
    throw new Error('useAppContext must be used within an AppProvider');
  }
  return context;
};


// --- UI KOMPONENTY (SHADCN/UI N√ÅHRADA) ---
// (Komponenty Button, Input, Textarea, Label, RadioGroup, Tabs, Progress, Badge, Card, Toast, ImageWithFallback, StarRating z≈Øst√°vaj√≠ beze zmƒõny)

// Button
const Button = forwardRef(
  ({ className = '', variant = 'default', size = 'default', ...props }, ref) => {
    const variants = {
      default: 'bg-black text-white hover:bg-gray-800',
      destructive: 'bg-red-600 text-white hover:bg-red-700',
      outline: 'border border-black bg-transparent hover:bg-gray-100',
      secondary: 'bg-gray-100 text-black hover:bg-gray-200',
      ghost: 'hover:bg-gray-100',
      link: 'text-black underline-offset-4 hover:underline',
    };
    const sizes = {
      default: 'h-10 px-4 py-2',
      sm: 'h-9 rounded-md px-3',
      lg: 'h-11 rounded-md px-8',
      icon: 'h-10 w-10',
    };
    const baseStyles = 'inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-black focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50';
    
    return (
      <button
        className={`${baseStyles} ${variants[variant]} ${sizes[size]} ${className}`}
        ref={ref}
        {...props}
      />
    );
  }
);

// Input
const Input = forwardRef(
  ({ className = '', ...props }, ref) => {
    return (
      <input
        className={`flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-black focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ${className}`}
        ref={ref}
        {...props}
      />
    );
  }
);

// Textarea
const Textarea = forwardRef(
  ({ className = '', ...props }, ref) => {
    return (
      <textarea
        className={`flex min-h-[80px] w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm ring-offset-white placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-black focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ${className}`}
        ref={ref}
        {...props}
      />
    );
  }
);

// Label
const Label = forwardRef(
  ({ className = '', ...props }, ref) => {
    return (
      <label
        className={`text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 ${className}`}
        ref={ref}
        {...props}
      />
    );
  }
);

// RadioGroup (Mock)
const RadioGroupContext = createContext(null);

const RadioGroup = ({
  value,
  onValueChange,
  name,
  children,
}) => {
  return (
    <RadioGroupContext.Provider value={{ name: name || 'radio-group', value, onChange: onValueChange }}>
      <div role="radiogroup" className="space-y-2">
        {children}
      </div>
    </RadioGroupContext.Provider>
  );
};

const RadioGroupItem = ({
  value,
  id,
  children,
  className = '',
}) => {
  const context = useContext(RadioGroupContext);
  if (!context) {
    throw new Error('RadioGroupItem must be used within a RadioGroup');
  }
  
  const isSelected = context.value === value;
  
  return (
    <div
      className={`flex items-center gap-4 rounded-lg border p-4 transition-all cursor-pointer ${
        isSelected ? 'border-black bg-gray-50 ring-2 ring-black' : 'border-gray-300 bg-white hover:bg-gray-50'
      } ${className}`}
      onClick={() => context.onChange(value)}
    >
      <button
        id={id}
        type="button"
        role="radio"
        aria-checked={isSelected}
        className="h-5 w-5 flex-shrink-0 rounded-full border-2 border-black flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-black focus:ring-offset-2"
      >
        {isSelected && <div className="h-2.5 w-2.5 rounded-full bg-black" />}
      </button>
      <Label htmlFor={id} className="cursor-pointer flex-1">
        {children}
      </Label>
    </div>
  );
};

// Tabs (Mock)
const TabsContext = createContext(null);

const Tabs = ({
  defaultValue,
  children,
}) => {
  const [activeTab, setActiveTab] = useState(defaultValue);
  return (
    <TabsContext.Provider value={{ activeTab, setActiveTab }}>
      <div>{children}</div>
    </TabsContext.Provider>
  );
};

const TabsList = ({ children, className = "" }) => (
  <div className={`flex items-center border-b border-gray-300 ${className}`}>
    {children}
  </div>
);

const TabsTrigger = ({
  value,
  children,
  className = ""
}) => {
  const context = useContext(TabsContext);
  if (!context) throw new Error('TabsTrigger must be used within a Tabs');
  
  const isActive = context.activeTab === value;
  
  return (
    <button
      type="button"
      role="tab"
      aria-selected={isActive}
      onClick={() => context.setActiveTab(value)}
      className={`-mb-px border-b-2 px-4 py-3 text-sm font-medium transition-colors ${
        isActive
          ? 'border-black text-black'
          : 'border-transparent text-gray-600 hover:border-gray-400 hover:text-black'
      } ${className}`}
    >
      {children}
    </button>
  );
};

const TabsContent = ({
  value,
  children,
  className = ""
}) => {
  const context = useContext(TabsContext);
  if (!context) throw new Error('TabsContent must be used within a Tabs');
  
  return context.activeTab === value ? (
    <div role="tabpanel" className={`py-6 ${className}`}>
      {children}
    </div>
  ) : null;
};

// Progress
const Progress = ({ value = 0, className = "" }) => {
  const clampedValue = Math.min(100, Math.max(0, value));
  return (
    <div
      className={`relative h-2 w-full overflow-hidden rounded-full bg-gray-200 ${className}`}
    >
      <div
        className="h-full w-full flex-1 bg-green-600 transition-all"
        style={{ transform: `translateX(-${100 - clampedValue}%)` }}
      />
    </div>
  );
};

// Badge
const Badge = ({
  variant = 'default',
  className = '',
  ...props
}) => {
  const variants = {
    default: 'border-transparent bg-black text-white',
    success: 'border-transparent bg-green-600 text-white',
    destructive: 'border-transparent bg-red-600 text-white',
  };
  return (
    <div
      className={`inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors ${variants[variant]} ${className}`}
      {...props}
    />
  );
};

// Card (Mock)
const Card = ({ className = '', ...props }) => (
  <div className={`rounded-lg border bg-white text-black shadow-sm ${className}`} {...props} />
);

const CardHeader = ({ className = '', ...props }) => (
  <div className={`flex flex-col space-y-1.5 p-6 ${className}`} {...props} />
);

const CardTitle = ({ className = '', ...props }) => (
  <h3 className={`text-lg font-semibold leading-none tracking-tight ${className}`} {...props} />
);

const CardDescription = ({ className = '', ...props }) => (
  <p className={`text-sm text-gray-600 ${className}`} {...props} />
);

const CardContent = ({ className = '', ...props }) => (
  <div className={`p-6 pt-0 ${className}`} {...props} />
);

const CardFooter = ({ className = '', ...props }) => (
  <div className={`flex items-center p-6 pt-0 ${className}`} {...props} />
);

// Toast (Sonner Mock)
const Toast = () => {
  const { toastMessage, clearToast } = useAppContext();
  
  if (!toastMessage) return null;
  
  return (
    <div className="fixed bottom-5 right-5 z-50">
      <div className="flex items-center justify-between gap-4 rounded-lg bg-black p-4 text-white shadow-lg animate-pulse">
        <span>{toastMessage}</span>
        <button onClick={clearToast} className="rounded-full p-1 hover:bg-gray-700">
          <IconX size={16} />
        </button>
      </div>
    </div>
  );
};

// Fallback pro obr√°zky
const ImageWithFallback = ({ src, alt, className = "", ...props }) => {
  return (
    <img
      src={src}
      alt={alt}
      className={className}
      onError={(e) => {
        (e.target).src = `https://placehold.co/600x600/e0e0e0/9ca3af?text=Obr√°zek+chyb√≠`;
      }}
      {...props}
    />
  );
};

// Komponenta pro hvƒõzdiƒçky
const StarRating = ({ rating, size = 20 }) => {
  return (
    <div className="flex items-center">
      {[...Array(5)].map((_, i) => (
        <IconStar
          key={i}
          size={size}
          className={i < Math.round(rating) ? 'text-black' : 'text-gray-300'}
        />
      ))}
    </div>
  );
};

// --- KOMPONENTY STR√ÅNEK ---

// Header
const Header = () => {
  const { navigateTo, totalCartItems } = useAppContext();
  
  return (
    <header className="sticky top-0 z-40 w-full bg-white shadow-sm">
      {/* Top Banner */}
      <div className="bg-black py-2.5 text-white">
        <div className="container mx-auto flex max-w-7xl items-center justify-center gap-2 px-4 text-sm font-medium">
          <IconTruck size={16} />
          <span>Doprava ZDARMA nad 1000 Kƒç!</span>
        </div>
      </div>
      
      {/* Hlavn√≠ navigace */}
      <nav className="container mx-auto flex max-w-7xl items-center justify-between p-4">
        {/* Lev√° strana - Logo */}
        <div
          className="flex cursor-pointer items-center gap-2"
          onClick={() => navigateTo('home')}
        >
          <span className="flex h-10 w-10 items-center justify-center rounded-full bg-black text-2xl">
            ü¶ä
          </span>
          <span className="text-lg font-bold tracking-tight">3D P≈ò√çVƒöSKY</span>
        </div>
        
        {/* St≈ôed - Menu (Desktop) */}
        <div className="hidden items-center gap-6 md:flex">
          <Button variant="link" onClick={() => navigateTo('home')}>Dom≈Ø</Button>
          <Button variant="link" onClick={() => navigateTo('product', 'fox')}>Kolekce</Button>
          <Button variant="link" onClick={() => navigateTo('printing')}>3D Tisk & Kvalita</Button>
          <Button variant="link" onClick={() => navigateTo('contact')}>Kontakt</Button>
        </div>
        
        {/* Prav√° strana - Ikony */}
        <div className="flex items-center gap-4">
          <Button variant="ghost" size="icon">
            <IconSearch size={20} />
          </Button>
          <Button variant="ghost" size="icon">
            <IconUser size={20} />
          </Button>
          <Button
            variant="ghost"
            size="icon"
            className="relative"
            onClick={() => navigateTo('cart')}
          >
            <IconShoppingBag size={20} />
            {totalCartItems > 0 && (
              <span className="absolute -top-1 -right-1 flex h-5 w-5 items-center justify-center rounded-full bg-black text-xs font-bold text-white">
                {totalCartItems}
              </span>
            )}
          </Button>
        </div>
      </nav>
    </header>
  );
};

// Footer
const Footer = () => {
  const { navigateTo } = useAppContext();
  
  return (
    <footer className="bg-black text-white">
      <div className="container mx-auto grid max-w-7xl grid-cols-1 gap-12 p-10 md:grid-cols-4">
        {/* Sloupec 1 - O n√°s */}
        <div className="space-y-4">
          <div className="flex items-center gap-2">
            <span className="flex h-10 w-10 items-center justify-center rounded-full bg-white text-2xl">
              ü¶ä
            </span>
            <span className="text-lg font-bold">3D P≈ò√çVƒöSKY</span>
          </div>
          <p className="text-sm text-gray-300">
            Origin√°ln√≠ 3D ti≈°tƒõn√© p≈ô√≠vƒõsky. Precizn√≠ design, ƒçesk√° v√Ωroba, jednotn√° cena 59 Kƒç.
          </p>
        </div>
        
        {/* Sloupec 2 - Rychl√© odkazy */}
        <div className="space-y-2">
          <h4 className="font-semibold">Rychl√© odkazy</h4>
          <ul className="space-y-1 text-sm text-gray-300">
            <li><Button variant="link" className="p-0 text-gray-300 hover:text-white" onClick={() => navigateTo('home')}>Dom≈Ø</Button></li>
            <li><Button variant="link" className="p-0 text-gray-300 hover:text-white" onClick={() => navigateTo('product', 'fox')}>Kolekce</Button></li>
            <li><Button variant="link" className="p-0 text-gray-300 hover:text-white" onClick={() => navigateTo('printing')}>3D Tisk & Kvalita</Button></li>
            <li><Button variant="link" className="p-0 text-gray-300 hover:text-white" onClick={() => navigateTo('contact')}>Kontakt</Button></li>
          </ul>
        </div>

        {/* Sloupec 3 - Z√°kaznick√Ω servis */}
        <div className="space-y-2">
          <h4 className="font-semibold">Z√°kaznick√Ω servis</h4>
          <ul className="space-y-1 text-sm text-gray-300">
            <li><button className="p-0 text-gray-300 hover:text-white hover:underline">ƒåasto kladen√© dotazy</button></li>
            <li><button className="p-0 text-gray-300 hover:text-white hover:underline">Doprava a platba</button></li>
            <li><button className="p-0 text-gray-300 hover:text-white hover:underline">Reklamace a vr√°cen√≠ zbo≈æ√≠</button></li>
            <li><button className="p-0 text-gray-300 hover:text-white hover:underline">Obchodn√≠ podm√≠nky</button></li>
          </ul>
        </div>
        
        {/* Sloupec 4 - Kontakt */}
        <div className="space-y-2">
          <h4 className="font-semibold">Kontakt</h4>
          <ul className="space-y-2 text-sm text-gray-300">
            <li><a href="mailto:sf.simonflorian@gmail.com" className="hover:text-white hover:underline">sf.simonflorian@gmail.com</a></li>
          </ul>
          <div className="flex gap-2 pt-2">
            <a href="#" className="rounded-full p-2 hover:bg-gray-700"><IconInstagram size={20} /></a>
            <a href="#" className="rounded-full p-2 hover:bg-gray-700"><IconFacebook size={20} /></a>
          </div>
        </div>
      </div>
      
      {/* Copyright */}
      <div className="container mx-auto max-w-7xl border-t border-gray-700 p-6 text-center">
        <p className="text-sm text-gray-400">
          ¬© 2025 3D P≈ô√≠vƒõsky. V≈°echna pr√°va vyhrazena.
        </p>
      </div>
    </footer>
  );
};

// Karta produktu
const ProductCard = ({ product }) => {
  const { navigateTo, addToCart } = useAppContext();
  
  return (
    <Card className="group cursor-pointer overflow-hidden" onClick={() => navigateTo('product', product.id)}>
      <CardContent className="p-0">
        <div className="aspect-square overflow-hidden">
          <ImageWithFallback
            src={product.images[0]}
            alt={product.name}
            className="h-full w-full object-cover transition-transform duration-300 group-hover:scale-105"
          />
        </div>
        <div className="p-4 space-y-2">
          <div>
            <h3 className="text-lg font-medium">{product.name}</h3>
            <p className="text-sm text-gray-600">{product.subtitle}</p>
          </div>
          <p className="text-lg font-semibold">{product.price} Kƒç</p>
          <Button
            className="w-full"
            onClick={(e) => {
              e.stopPropagation();
              addToCart(product.id, 1);
            }}
          >
            <IconShoppingBag size={16} className="mr-2" />
            P≈ôidat do ko≈°√≠ku
          </Button>
        </div>
      </CardContent>
    </Card>
  );
};

// Domovsk√° str√°nka
const HomePage = () => {
  const { navigateTo } = useAppContext();
  
  return (
    <div className="space-y-16 md:space-y-24">
      {/* Hero sekce */}
      <section className="bg-black text-white">
        <div className="container mx-auto grid max-w-7xl grid-cols-1 items-center gap-8 px-4 py-16 md:grid-cols-2 md:py-24">
          <div className="space-y-6 text-center md:text-left">
            <h1 className="text-4xl font-bold tracking-tighter md:text-5xl lg:text-6xl">
              Precizn√≠ design. Cena, co potƒõ≈°√≠.
            </h1>
            <p className="text-lg text-gray-300 md:text-xl">
              Objevte 3D ti≈°tƒõn√© p≈ô√≠vƒõsky s propracovan√Ωmi detaily. Jednotn√° cena 59 Kƒç.
            </p>
            <Button
              size="lg"
              className="bg-white text-black hover:bg-gray-200"
              onClick={() => navigateTo('product', 'dog')}
            >
              Koupit za 59 Kƒç
            </Button>
          </div>
          <div className="flex justify-center">
            <ImageWithFallback
              src={IMAGES.dog_vanoce}
              alt="P≈ô√≠vƒõsek Pes V√°noce"
              className="w-full max-w-md rounded-lg object-cover"
            />
          </div>
        </div>
      </section>
      
      {/* Produktov√° kolekce */}
      <section className="container mx-auto max-w-7xl px-4">
        <div className="mx-auto max-w-3xl text-center">
          <h2 className="text-3xl font-bold tracking-tighter md:text-4xl">Na≈°e st√°l√° nab√≠dka a novinky</h2>
          <p className="mt-4 text-lg text-gray-600">
            Ka≈æd√Ω p≈ô√≠vƒõsek je vyroben s maxim√°ln√≠ p√©ƒç√≠ o detail pomoc√≠ pokroƒçil√© technologie 3D tisku.
          </p>
        </div>
        <div className="mt-12 grid grid-cols-1 gap-6 md:grid-cols-2 lg:gap-8">
          <ProductCard product={PRODUCT_DATA.fox} />
          <ProductCard product={PRODUCT_DATA.dog} />
        </div>
      </section>
      
      {/* 3D Technology sekce */}
      <section className="bg-gray-50/70 py-16 md:py-24">
        <div className="container mx-auto max-w-7xl px-4">
          <div className="mx-auto max-w-3xl text-center">
            <h2 className="text-3xl font-bold tracking-tighter md:text-4xl">Kvalita z PLA filamentu</h2>
            <p className="mt-4 text-lg text-gray-600">
              V≈°echny na≈°e produkty tiskneme z pr√©miov√©ho PLA, co≈æ je ekologick√Ω a vysoce odoln√Ω bioplast.
            </p>
          </div>
          <div className="mt-12 grid grid-cols-1 gap-8 md:grid-cols-3">
            <div className="rounded-lg bg-white p-6 text-center shadow-sm">
              <div className="mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-black text-white">
                <IconLeaf size={28} />
              </div>
              <h3 className="mt-4 text-xl font-semibold">Materi√°l PLA</h3>
              <p className="mt-2 text-gray-600">Ekologick√Ω a pevn√Ω bioplast z kuku≈ôiƒçn√©ho ≈°krobu.</p>
            </div>
            <div className="rounded-lg bg-white p-6 text-center shadow-sm">
              <div className="mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-black text-white">
                <IconAward size={28} />
              </div>
              <h3 className="mt-4 text-xl font-semibold">Odoln√Ω a Lehk√Ω</h3>
              <p className="mt-2 text-gray-600">Perfektn√≠ balanc pro ka≈ædodenn√≠ no≈°en√≠ a dlouhou ≈æivotnost.</p>
            </div>
            <div className="rounded-lg bg-white p-6 text-center shadow-sm">
              <div className="mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-black text-white">
                <IconPrinter size={28} />
              </div>
              <h3 className="mt-4 text-xl font-semibold">ƒåesk√Ω Design</h3>
              <p className="mt-2 text-gray-600">Vyrobeno s preciznost√≠ a p√©ƒç√≠ v ƒåesk√© republice.</p>
            </div>
          </div>
          <div className="mt-12 text-center">
            <Button variant="outline" size="lg" onClick={() => navigateTo('printing')}>
              V√≠ce o V√Ωrobƒõ
            </Button>
          </div>
        </div>
      </section>
      
      {/* Social Proof sekce */}
      <section className="container mx-auto max-w-7xl px-4">
        <div className="mx-auto max-w-3xl text-center">
          <h2 className="text-3xl font-bold tracking-tighter md:text-4xl">Doporuƒçuj√≠ Z√°kazn√≠ci</h2>
          <div className="mt-4 flex items-center justify-center gap-2">
            <StarRating rating={4.9} />
            <span className="text-lg font-medium text-gray-800">4.9 / 5</span>
          </div>
          <blockquote className="mt-6 text-lg italic text-gray-700">
            "Za tuhle cenu naprost√° bomba! Kvalita 3D tisku je skvƒõl√°, materi√°l je p≈ô√≠jemn√Ω a odoln√Ω. Koupila jsem li≈°ku i psa a oba vypadaj√≠ √∫≈æasnƒõ na batohu."
            <footer className="mt-4 block text-base not-italic text-gray-600">‚Äì Tereza N., Ovƒõ≈ôen√Ω z√°kazn√≠k</footer>
          </blockquote>
          <p className="mt-8 text-lg font-medium text-gray-800">
            Sd√≠lejte s n√°mi! <span className="text-black">#3DPrivesky</span>
          </p>
        </div>
        <div className="mt-12 grid grid-cols-2 gap-4 md:grid-cols-3">
          <ImageWithFallback src={IMAGES.fox_batoh} alt="Li≈°ka na batohu" className="aspect-square w-full rounded-lg object-cover shadow-sm transition-transform hover:scale-105" />
          <ImageWithFallback src={IMAGES.dog_dvere} alt="Pes u dve≈ô√≠" className="aspect-square w-full rounded-lg object-cover shadow-sm transition-transform hover:scale-105" />
          <ImageWithFallback src={IMAGES.fox_klice} alt="Li≈°ka na kl√≠ƒç√≠ch" className="aspect-square w-full rounded-lg object-cover shadow-sm transition-transform hover:scale-105" />
          <ImageWithFallback src={IMAGES.dog_batoh} alt="Pes na batohu" className="aspect-square w-full rounded-lg object-cover shadow-sm transition-transform hover:scale-105" />
          <ImageWithFallback src={IMAGES.fox_les} alt="Li≈°ka v lese" className="aspect-square w-full rounded-lg object-cover shadow-sm transition-transform hover:scale-105" />
          <ImageWithFallback src={IMAGES.dog_vanoce} alt="Pes v√°noce" className="aspect-square w-full rounded-lg object-cover shadow-sm transition-transform hover:scale-105" />
        </div>
      </section>
      
      {/* Newsletter sekce */}
      <section className="bg-gray-50/70 py-16 md:py-24">
        <div className="container mx-auto max-w-3xl px-4 text-center">
          <h2 className="text-3xl font-bold tracking-tighter md:text-4xl">Sledujte Novinky a Akce</h2>
          <p className="mt-4 text-lg text-gray-600">
            P≈ôihlaste se k odbƒõru a buƒète prvn√≠, kdo se dozv√≠ o nov√Ωch produktech a speci√°ln√≠ch nab√≠dk√°ch.
          </p>
          <form className="mt-8 flex flex-col gap-4 sm:flex-row">
            <Input type="email" placeholder="V√°≈° e-mail" className="flex-1" />
            <Button type="submit" size="lg" className="w-full sm:w-auto">Odeb√≠rat</Button>
          </form>
        </div>
      </section>
    </div>
  );
};

// Detail produktu
const ProductDetailPage = () => {
  const { currentProduct, navigateTo, addToCart } = useAppContext();
  const product = PRODUCT_DATA[currentProduct];
  
  const [mainImage, setMainImage] = useState(product.images[0]);
  const [quantity, setQuantity] = useState(1);
  
  const averageRating = useMemo(() => {
    return product.reviews.reduce((acc, r) => acc + r.rating, 0) / product.reviews.length;
  }, [product.reviews]);
  
  const handleQuantityChange = (amount) => {
    setQuantity(prev => Math.max(1, prev + amount));
  };

  const handleAddToCart = () => {
    addToCart(product.id, quantity);
    setQuantity(1);
  };
  
  return (
    <div className="container mx-auto max-w-7xl px-4 py-8 md:py-12">
      {/* Breadcrumbs */}
      <nav className="mb-6 flex items-center gap-2 text-sm text-gray-600">
        <Button variant="link" className="p-0 text-gray-600" onClick={() => navigateTo('home')}>Dom≈Ø</Button>
        <IconChevronRight size={16} />
        <Button variant="link" className="p-0 text-gray-600" onClick={() => navigateTo('product', 'fox')}>Kolekce</Button>
        <IconChevronRight size={16} />
        <span className="font-medium text-black">{product.name}</span>
      </nav>
      
      <div className="grid grid-cols-1 gap-12 md:grid-cols-2">
        {/* Lev√° strana - Obr√°zky */}
        <div className="space-y-4">
          <div className="aspect-square w-full overflow-hidden rounded-lg border">
            <ImageWithFallback src={mainImage} alt={product.name} className="h-full w-full object-cover" />
          </div>
          <div className="grid grid-cols-4 gap-4">
            {product.images.map((img, idx) => (
              <button
                key={idx}
                className={`aspect-square w-full overflow-hidden rounded-md border-2 transition-colors ${
                  mainImage === img ? 'border-black' : 'border-gray-200 hover:border-gray-400'
                }`}
                onClick={() => setMainImage(img)}
              >
                <ImageWithFallback src={img} alt={`N√°hled ${idx + 1}`} className="h-full w-full object-cover" />
              </button>
            ))}
          </div>
        </div>
        
        {/* Prav√° strana - Info */}
        <div className="space-y-6">
          <h1 className="text-3xl font-bold md:text-4xl">{product.name}</h1>
          <p className="text-3xl font-semibold">{product.price} Kƒç</p>
          
          <div className="flex items-center gap-2">
            <StarRating rating={averageRating} />
            <span className="text-sm text-gray-600">({averageRating.toFixed(1)}/5 ¬∑ {product.reviews.length} hodnocen√≠)</span>
          </div>
          
          <p className="text-base text-gray-700">{product.description}</p>
          
          <div className="space-y-4 rounded-lg bg-gray-50/70 p-4">
            <ul className="space-y-2 text-sm">
              <li><strong>Rozmƒõry:</strong> {product.details.dimensions}</li>
              <li><strong>Materi√°l:</strong> {product.details.material}</li>
              <li><strong>Barvy:</strong> {product.details.colors}</li>
            </ul>
            <Badge variant="success">Skladem</Badge>
          </div>
          
          {/* Poƒçet kus≈Ø */}
          <div className="space-y-2">
            <Label htmlFor="quantity">Poƒçet kus≈Ø</Label>
            <div className="flex w-fit items-center rounded-md border">
              <Button variant="ghost" size="icon" onClick={() => handleQuantityChange(-1)} disabled={quantity <= 1} className="h-11 rounded-r-none border-r">
                <IconMinus />
              </Button>
              <span id="quantity" className="w-12 text-center text-lg font-medium">{quantity}</span>
              <Button variant="ghost" size="icon" onClick={() => handleQuantityChange(1)} className="h-11 rounded-l-none border-l">
                <IconPlus />
              </Button>
            </div>
          </div>
          
          <Button size="lg" className="w-full" onClick={handleAddToCart}>
            P≈ôidat do ko≈°√≠ku za {product.price * quantity} Kƒç
          </Button>
          
          {/* Z√°ruky */}
          <div className="space-y-3 border-t pt-6 text-sm text-gray-700">
            <div className="flex items-center gap-3">
              <IconTruck size={20} className="text-green-600" />
              <span>Doprava ZDARMA nad 1000 Kƒç</span>
            </div>
            <div className="flex items-center gap-3">
              <IconAward size={20} className="text-black" />
              <span>Garance 30 dn√≠ na vr√°cen√≠</span>
            </div>
            <div className="flex items-center gap-3">
              <IconPrinter size={20} className="text-black" />
              <span>ƒåesk√° v√Ωroba</span>
            </div>
          </div>
        </div>
      </div>
      
      {/* Tabs sekce */}
      <div className="mt-16 md:mt-24">
        <Tabs defaultValue="description">
          <TabsList>
            <TabsTrigger value="description">Popis</TabsTrigger>
            <TabsTrigger value="reviews">Hodnocen√≠ ({product.reviews.length})</TabsTrigger>
          </TabsList>
          
          <TabsContent value="description" className="prose max-w-none text-gray-700">
            <h3>O Produktu</h3>
            <p>{product.description} Tento p≈ô√≠vƒõsek je navr≈æen tak, aby byl lehk√Ω na no≈°en√≠, ale z√°rove≈à dostateƒçnƒõ pevn√Ω, aby vydr≈æel ka≈ædodenn√≠ pou≈æ√≠v√°n√≠ na kl√≠ƒç√≠ch, batohu nebo ta≈°ce. D√≠ky precizn√≠mu 3D tisku jsou viditeln√© i ty nejmen≈°√≠ detaily.</p>
            <h3>Materi√°l a Kvalita</h3>
            <p>Pou≈æ√≠v√°me v√Ωhradnƒõ PLA (Polylactic Acid) filament, co≈æ je bioplast vyroben√Ω z obnoviteln√Ωch zdroj≈Ø, jako je kuku≈ôiƒçn√Ω ≈°krob. Je ekologicky ≈°etrn√Ω a biologicky odbourateln√Ω. PLA je zn√°m√© svou pevnost√≠, n√≠zkou hmotnost√≠ a schopnost√≠ zachytit ≈æiv√© barvy.</p>
            <h3>P√©ƒçe o Produkt</h3>
            <p>P≈ô√≠vƒõsek je odoln√Ω, ale pro zachov√°n√≠ jeho kr√°sy ho nevystavujte extr√©mnƒõ vysok√Ωm teplot√°m (nap≈ô. v autƒõ na p≈ô√≠m√©m slunci v l√©tƒõ) ani dlouhodob√©mu p≈Øsoben√≠ vody. ƒåistƒõte jej snadno such√Ωm nebo m√≠rnƒõ navlhƒçen√Ωm had≈ô√≠kem.</p>
          </TabsContent>
          
          <TabsContent value="reviews">
            <h3 className="text-xl font-semibold">Hodnocen√≠ z√°kazn√≠k≈Ø</h3>
            <div className="mt-4 space-y-6">
              {product.reviews.map(review => (
                <div key={review.id} className="border-b pb-6">
                  <div className="flex items-center justify-between">
                    <StarRating rating={review.rating} />
                    <span className="text-sm text-gray-500">{review.date}</span>
                  </div>
                  <h4 className="mt-2 text-base font-medium">{review.author}</h4>
                  <p className="mt-1 text-gray-700">{review.text}</p>
                </div>
              ))}
            </div>
          </TabsContent>
        </Tabs>
      </div>
      
      {/* Souvisej√≠c√≠ produkty */}
      <div className="mt-16 md:mt-24">
        <h2 className="text-3xl font-bold tracking-tighter">Mohlo by se v√°m l√≠bit</h2>
        <div className="mt-8 grid grid-cols-1 gap-6 md:grid-cols-2">
          <ProductCard product={product.id === 'fox' ? PRODUCT_DATA.dog : PRODUCT_DATA.fox} />
        </div>
      </div>
    </div>
  );
};

// Str√°nka ko≈°√≠ku
const CartPage = () => {
  const { cart, navigateTo, updateCartItemQuantity, removeFromCart, totalCartItems, cartSubtotal, shippingCost, totalPrice } = useAppContext();
  
  const remainingForFreeShipping = FREE_SHIPPING_THRESHOLD - cartSubtotal;
  const freeShippingProgress = Math.min(100, (cartSubtotal / FREE_SHIPPING_THRESHOLD) * 100);

  return (
    <React.Fragment>
      <section className="bg-black text-white">
        <div className="container mx-auto max-w-7xl px-4 py-12 text-center">
          <h1 className="text-4xl font-bold tracking-tighter">N√°kupn√≠ Ko≈°√≠k</h1>
        </div>
      </section>
      
      <div className="container mx-auto max-w-7xl px-4 py-12">
        {cart.length === 0 ? (
          // Pr√°zdn√Ω ko≈°√≠k
          <div className="flex flex-col items-center justify-center gap-6 rounded-lg border-2 border-dashed border-gray-300 p-16 text-center">
            <IconShoppingBag size={64} className="text-gray-400" />
            <h2 className="text-2xl font-semibold">V√°≈° ko≈°√≠k je pr√°zdn√Ω</h2>
            <p className="text-gray-600">Vypad√° to, ≈æe jste je≈°tƒõ nic nep≈ôidali. Pojƒème to napravit!</p>
            <Button size="lg" onClick={() => navigateTo('product', 'fox')}>
              Prozkoumat Kolekci
            </Button>
          </div>
        ) : (
          // Pln√Ω ko≈°√≠k
          <div className="grid grid-cols-1 gap-12 lg:grid-cols-3">
            {/* Lev√Ω sloupec - Produkty */}
            <div className="space-y-6 lg:col-span-2">
              <h2 className="text-2xl font-semibold">Produkty v ko≈°√≠ku ({totalCartItems})</h2>
              <div className="space-y-4">
                {cart.map(item => {
                  const product = PRODUCT_DATA[item.id];
                  return (
                    <Card key={item.id} className="flex flex-col gap-4 p-4 md:flex-row md:items-center">
                      <ImageWithFallback
                        src={product.images[0]}
                        alt={product.name}
                        className="h-24 w-24 flex-shrink-0 cursor-pointer rounded-md object-cover"
                        onClick={() => navigateTo('product', item.id)}
                      />
                      <div className="flex-1 space-y-2">
                        <h3 
                          className="text-lg font-medium cursor-pointer hover:underline"
                          onClick={() => navigateTo('product', item.id)}
                        >
                          {product.name}
                        </h3>
                        <p className="text-sm text-gray-600">{product.subtitle}</p>
                        {/* Quantity controls */}
                        <div className="flex w-fit items-center rounded-md border">
                          <Button variant="ghost" size="icon" onClick={() => updateCartItemQuantity(item.id, item.quantity - 1)} className="h-9 w-9 rounded-r-none border-r">
                            <IconMinus size={14} />
                          </Button>
                          <span className="w-10 text-center text-base font-medium">{item.quantity}</span>
                          <Button variant="ghost" size="icon" onClick={() => updateCartItemQuantity(item.id, item.quantity + 1)} className="h-9 w-9 rounded-l-none border-l">
                            <IconPlus size={14} />
                          </Button>
                        </div>
                      </div>
                      <div className="flex items-center gap-4 md:flex-col md:items-end">
                        <p className="text-lg font-semibold">{item.quantity * product.price} Kƒç</p>
                        <Button variant="ghost" size="icon" onClick={() => removeFromCart(item.id)}>
                          <IconTrash size={18} className="text-gray-600 hover:text-red-600" />
                        </Button>
                      </div>
                    </Card>
                  );
                })}
              </div>
            </div>
            
            {/* Prav√Ω sloupec - Souhrn */}
            <div className="lg:col-span-1">
              <div className="sticky top-28 space-y-6 rounded-lg bg-gray-50/70 p-6 shadow-sm">
                <h2 className="text-2xl font-semibold">Souhrn objedn√°vky</h2>
                
                {/* Free shipping progress */}
                <div className="space-y-2">
                  <div className="flex items-center justify-between text-sm font-medium">
                    <div className="flex items-center gap-2">
                      <IconTruck size={16} />
                      {remainingForFreeShipping <= 0 ? (
                        <span className="text-green-600">Gratulujeme! Doprava zdarma!</span>
                      ) : (
                        <span>Zb√Ωv√° {remainingForFreeShipping} Kƒç do dopravy zdarma!</span>
                      )}
                    </div>
                  </div>
                  <Progress value={freeShippingProgress} />
                </div>
                
                {/* Cenov√Ω rozpis */}
                <div className="space-y-3 border-b pb-4">
                  <div className="flex justify-between text-gray-700">
                    <span>Mezisouƒçet:</span>
                    <span>{cartSubtotal} Kƒç</span>
                  </div>
                  <div className="flex justify-between text-gray-700">
                    <span>Doprava:</span>
                    {shippingCost === 0 ? (
                      <span className="font-medium text-green-600">ZDARMA</span>
                    ) : (
                      <span>{shippingCost} Kƒç</span>
                    )}
                  </div>
                </div>
                
                <div className="flex justify-between text-xl font-bold">
                  <span>Celkem:</span>
                  <span>{totalPrice} Kƒç</span>
                </div>
                
                <Button size="lg" className="w-full" onClick={() => navigateTo('checkout')}>
                  Pokraƒçovat k dopravƒõ a platbƒõ
                </Button>
                <Button variant="outline" className="w-full" onClick={() => navigateTo('product', 'fox')}>
                  Pokraƒçovat v n√°kupu
                </Button>
              </div>
            </div>
          </div>
        )}
      </div>
    </React.Fragment>
  );
};

// Str√°nka Checkout
const CheckoutPage = () => {
  const {
    navigateTo,
    shippingOptionId,
    selectShippingOption,
    selectedPickupPoint,
    selectPickupPoint,
    shippingAddress,
    setShippingAddress,
    showToast,
    submitOrder,
    cart,
    cartSubtotal,
    shippingCost,
    totalPrice,
    // ==================================================================
    // ### KROK 3 - ZMƒöNA #4: Naƒçten√≠ `isSubmitting` z kontextu ###
    // ==================================================================
    isSubmitting 
  } = useAppContext();
  
  // Stavy pro kontaktn√≠ √∫daje
  const [email, setEmail] = useState('');
  const [phone, setPhone] = useState('');

  const selectedOption = SHIPPING_OPTIONS_DATA.find(opt => opt.id === shippingOptionId);
  const isAddressDelivery = selectedOption?.type === 'address';
  
  // *** Zde pat≈ô√≠ v√°≈° API kl√≠ƒç k Z√°silkovnƒõ ***
  const PACKETA_API_KEY = 'VASE_VEREJNE_API_ID_ZASILKOVNA';
  
  const handleOpenPacketaWidget = () => {
      if (!window.Packeta) {
        showToast("Chyba: Widget Z√°silkovny se nenahr√°l.");
        return;
      }
      
      try {
          Packeta.Widget.pick(PACKETA_API_KEY, (point) => {
            if (point) {
              console.log("Vybran√© m√≠sto (Z√°silkovna):", point);
              selectPickupPoint(point);
            } else {
              console.log("U≈æivatel zav≈ôel widget Z√°silkovny bez v√Ωbƒõru.");
            }
          }, {
             language: 'cs',
             country: 'cz',
          });
      } catch (e) {
          console.error("Chyba p≈ôi otev√≠r√°n√≠ Packeta widgetu:", e);
          showToast("Chyba p≈ôi otev√≠r√°n√≠ widgetu Z√°silkovny.");
      }
  };
  
  const handleOpenBalikovnaWidget = () => {
      if (!window.Balikovna) {
        showToast("Chyba: Widget Bal√≠kovny se nenahr√°l.");
        return;
      }

      try {
          const callback = (data) => {
            if (data && data.id) {
                const mappedPoint = {
                    id: data.id,
                    name: data.name,
                    street: data.street,
                    city: data.city,
                    zip: data.postcode,
                };
                console.log("Vybran√© m√≠sto (Bal√≠kovna JS):", mappedPoint);
                selectPickupPoint(mappedPoint);
            } else {
                console.log("U≈æivatel zav≈ôel widget Bal√≠kovny (JS) bez v√Ωbƒõru.");
            }
          };
          
          Balikovna.vybrat(callback);

      } catch (e) {
          console.error("Chyba p≈ôi otev√≠r√°n√≠ Balikovna widgetu (JS):", e);
          showToast("Chyba p≈ôi otev√≠r√°n√≠ widgetu Bal√≠kovny.");
      }
  };

  
  const handleSimulateSubmitOrder = () => {
    // Validace
    if (!email || !phone) {
        showToast('Pros√≠m vypl≈àte e-mail a telefon');
        return;
    }

    if (isAddressDelivery) {
      if (!shippingAddress.city || !shippingAddress.zip || !shippingAddress.street || !shippingAddress.number) {
        showToast('Pros√≠m vypl≈àte v≈°echny adresn√≠ √∫daje');
        return;
      }
    } else {
      if (!selectedPickupPoint) {
        showToast('Pros√≠m vyberte v√Ωdejn√≠ m√≠sto');
        return;
      }
    }
    
    // Sestaven√≠ dat pro odesl√°n√≠
    const contactDetails = {
        email,
        phone,
        address: isAddressDelivery ? shippingAddress : null
    };
    
    const orderDetails = {
        items: cart,
        subtotal: cartSubtotal,
        shippingCost: shippingCost,
        total: totalPrice
    };

    const selectedShipping = SHIPPING_OPTIONS_DATA.find(opt => opt.id === shippingOptionId);
    
    const selectedPickup = selectedPickupPoint;

    // Vol√°n√≠ nov√© funkce pro odesl√°n√≠
    submitOrder(contactDetails, orderDetails, selectedShipping, selectedPickup);
  };
  
  const handleAddressChange = (e) => {
    setShippingAddress({ [e.target.name]: e.target.value });
  };
  
  return (
    <React.Fragment>
      <section className="bg-black text-white">
        <div className="container mx-auto max-w-7xl px-4 py-12 text-center">
          <h1 className="text-4xl font-bold tracking-tighter">Doprava a Platba</h1>
        </div>
      </section>
      
      <div className="container mx-auto max-w-7xl px-4 py-12">
        {cart.length === 0 ? (
            <div className="flex flex-col items-center justify-center gap-6 rounded-lg border-2 border-dashed border-gray-300 p-16 text-center">
                <IconShoppingBag size={64} className="text-gray-400" />
                <h2 className="text-2xl font-semibold">V√°≈° ko≈°√≠k je pr√°zdn√Ω</h2>
                <p className="text-gray-600">Nelze pokraƒçovat k pokladnƒõ bez produkt≈Ø.</p>
                <Button size="lg" onClick={() => navigateTo('home')}>
                    Zpƒõt na domovskou str√°nku
                </Button>
            </div>
        ) : (
            <div className="grid grid-cols-1 gap-12 lg:grid-cols-3">
            {/* Lev√Ω sloupec - Formul√°≈ôe */}
            <div className="space-y-8 lg:col-span-2">
                
                {/* Kontaktn√≠ √∫daje */}
                <section>
                    <h2 className="mb-4 text-2xl font-semibold">1. Kontaktn√≠ √∫daje</h2>
                    <Card className="bg-gray-50/70">
                        <CardContent className="pt-6 space-y-4">
                            <div className="grid grid-cols-1 gap-4 sm:grid-cols-2">
                                <div>
                                    <Label htmlFor="email">E-mail (povinn√©)</Label>
                                    <Input id="email" name="email" type="email" value={email} onChange={(e) => setEmail(e.target.value)} />
                                </div>
                                <div>
                                    <Label htmlFor="phone">Telefon (povinn√©)</Label>
                                    <Input id="phone" name="phone" type="tel" value={phone} onChange={(e) => setPhone(e.target.value)} />
                                </div>
                            </div>
                        </CardContent>
                    </Card>
                </section>

                {/* V√Ωbƒõr dopravy */}
                <section>
                <h2 className="mb-4 text-2xl font-semibold">2. V√Ωbƒõr dopravy</h2>
                <RadioGroup
                    value={shippingOptionId || ''}
                    onValueChange={selectShippingOption}
                    name="shippingOption"
                >
                    {SHIPPING_OPTIONS_DATA.map(option => (
                    <RadioGroupItem key={option.id} value={option.id} id={option.id}>
                        <div className="flex w-full items-center justify-between">
                        <div className="flex items-center gap-3">
                            <span className="flex items-center gap-1.5 text-lg">{option.icon}</span>
                            <span className="font-medium">{option.name}</span>
                        </div>
                        <span className="font-semibold">{option.price === 0 ? 'ZDARMA' : `${option.price} Kƒç`}</span>
                        </div>
                    </RadioGroupItem>
                    ))}
                </RadioGroup>
                </section>
                
                {/* Doruƒçovac√≠ √∫daje */}
                <section>
                <h2 className="mb-4 text-2xl font-semibold">3. Doruƒçovac√≠ √∫daje</h2>
                {isAddressDelivery ? (
                    // Formul√°≈ô pro adresu
                    <Card className="bg-gray-50/70">
                    <CardHeader>
                        <CardTitle>Doruƒçovac√≠ adresa (povinn√©)</CardTitle>
                    </CardHeader>
                    <CardContent className="space-y-4">
                        <div className="grid grid-cols-1 gap-4 sm:grid-cols-3">
                        <div className="sm:col-span-2">
                            <Label htmlFor="city">Mƒõsto</Label>
                            <Input id="city" name="city" value={shippingAddress.city} onChange={handleAddressChange} />
                        </div>
                        <div>
                            <Label htmlFor="zip">PSƒå</Label>
                            <Input id="zip" name="zip" value={shippingAddress.zip} onChange={handleAddressChange} />
                        </div>
                        </div>
                        <div className="grid grid-cols-1 gap-4 sm:grid-cols-3">
                        <div className="sm:col-span-2">
                            <Label htmlFor="street">Ulice</Label>
                            <Input id="street" name="street" value={shippingAddress.street} onChange={handleAddressChange} />
                        </div>
                        <div>
                            <Label htmlFor="number">ƒå√≠slo popisn√©</Label>
                            <Input id="number" name="number" value={shippingAddress.number} onChange={handleAddressChange} />
                        </div>
                        </div>
                    </CardContent>
                    </Card>
                ) : (
                    // V√Ωbƒõr v√Ωdejn√≠ho m√≠sta
                    <Card className="bg-gray-50/70">
                    <CardHeader>
                        <CardTitle>Vyberte v√Ωdejn√≠ m√≠sto (povinn√©)</CardTitle>
                    </CardHeader>
                    <CardContent className="space-y-4">
                        
                        {/* Podm√≠nƒõn√° tlaƒç√≠tka pro widgety */}
                        {shippingOptionId === 'zasil_box' && (
                            <Button className="w-full" size="lg" onClick={handleOpenPacketaWidget}>
                                <IconPost className="mr-2" /> Vybrat Z-Box / V√Ωdejn√≠ m√≠sto
                            </Button>
                        )}
                        {shippingOptionId === 'balik_box' && (
                            <Button className="w-full" size="lg" onClick={handleOpenBalikovnaWidget}>
                                <IconPackage className="mr-2" /> Vybrat Bal√≠kovnu
                            </Button>
                        )}
                        
                        {/* Zobrazen√≠ vybran√©ho m√≠sta (spoleƒçn√© pro v≈°echny) */}
                        {selectedPickupPoint ? (
                            <div className="mt-4 rounded-lg border bg-white p-4 ring-2 ring-green-500">
                                <div className="flex justify-between items-center">
                                    <p className="text-sm font-medium text-green-700">Vybran√© m√≠sto:</p>
                                    <Button variant="link" size="sm" className="p-0 text-red-600 h-auto" onClick={() => selectPickupPoint(null)}>
                                        Zmƒõnit
                                    </Button>
                                </div>
                                <p className="mt-1 font-semibold">{selectedPickupPoint.name}</p>
                                <p className="text-sm text-gray-600">{selectedPickupPoint.street}</p>
                                <p className="text-sm text-gray-600">{selectedPickupPoint.zip} {selectedPickupPoint.city}</p>
                            </div>
                        ) : (
                            !isAddressDelivery && (
                                <div className="mt-4 text-sm text-gray-600">
                                    Pros√≠m, vyberte v√Ωdejn√≠ m√≠sto kliknut√≠m na tlaƒç√≠tko v√Ω≈°e.
                                </div>
                            )
                        )}
                        
                    </CardContent>
                    </Card>
                )}
                </section>
            </div>
            
            {/* Prav√Ω sloupec - Souhrn */}
            <div className="lg:col-span-1">
                <div className="sticky top-28 space-y-6 rounded-lg bg-gray-50/70 p-6 shadow-sm">
                <h2 className="text-2xl font-semibold">Souhrn objedn√°vky</h2>
                
                {/* Miniatury produkt≈Ø */}
                <div className="space-y-3 border-b pb-4">
                    {cart.map(item => {
                    const product = PRODUCT_DATA[item.id];
                    return (
                        <div key={item.id} className="flex items-center gap-3">
                        <ImageWithFallback
                            src={product.images[0]}
                            alt={product.name}
                            className="h-12 w-12 rounded-md object-cover border"
                        />
                        <div className="flex-1 text-sm">
                            <div className="font-medium">{product.name}</div>
                            <div className="text-gray-600">Mno≈æstv√≠: {item.quantity}</div>
                        </div>
                        <div className="text-sm font-semibold">{item.quantity * product.price} Kƒç</div>
                        </div>
                    );
                    })}
                </div>
                
                {/* Cenov√Ω rozpis */}
                <div className="space-y-3 border-b pb-4">
                    <div className="flex justify-between text-gray-700">
                    <span>Mezisouƒçet:</span>
                    <span>{cartSubtotal} Kƒç</span>
                    </div>
                    <div className="flex justify-between text-gray-700">
                    <span>Doprava:</span>
                    <span className="font-medium">{shippingCost === 0 ? 'ZDARMA' : `${shippingCost} Kƒç`}</span>
                    </div>
                </div>
                
                <div className="flex justify-between text-xl font-bold">
                    <span>Celkem:</span>
                    <span>{totalPrice} Kƒç</span>
                </div>
                
                {/* ================================================================== */}
                {/* ### KROK 3 - ZMƒöNA #5: √öprava tlaƒç√≠tka pro zobrazen√≠ loading stavu ### */}
                {/* ================================================================== */}
                <Button 
                    size="lg" 
                    className="w-full" 
                    onClick={handleSimulateSubmitOrder} 
                    disabled={isSubmitting}
                >
                    {isSubmitting ? 'Odes√≠l√°m...' : 'Odeslat objedn√°vku'}
                </Button>

                <Button variant="outline" className="w-full" onClick={() => navigateTo('cart')}>
                    Zpƒõt do ko≈°√≠ku
                </Button>
                <p className="text-xs text-gray-600 text-center">
                    Kliknut√≠m na "Odeslat objedn√°vku" bude objedn√°vka zaznamen√°na a obdr≈æ√≠te potvrzovac√≠ e-mail.
                </p>
                </div>
            </div>
            </div>
        )}
      </div>

    </React.Fragment>
  );
};

// Str√°nka Potvrzen√≠ objedn√°vky
const ConfirmationPage = () => {
    const { orderConfirmation, navigateTo } = useAppContext();

    if (!orderConfirmation) {
        React.useEffect(() => {
            navigateTo('home');
        }, [navigateTo]);
        return null;
    }

    const { orderId, contact, order, shippingOption, pickupPoint } = orderConfirmation;
    const isAddressDelivery = !!contact.address;

    return (
        <React.Fragment>
            <section className="bg-green-600 text-white">
                <div className="container mx-auto max-w-7xl px-4 py-16 text-center">
                    <IconCheckCircle size={64} className="mx-auto" />
                    <h1 className="mt-6 text-4xl font-bold tracking-tighter">Objedn√°vka potvrzena!</h1>
                    <p className="mt-4 text-lg text-green-100">
                        Dƒõkujeme za v√°≈° n√°kup. Shrnut√≠ jsme v√°m pr√°vƒõ odeslali na e-mail.
                    </p>
                </div>
            </section>

            <section className="container mx-auto max-w-3xl px-4 py-16">
                <div className="space-y-8 rounded-lg border bg-gray-50/70 p-8 shadow-sm">
                    <h2 className="text-center text-2xl font-semibold">
                        Souhrn objedn√°vky ƒç. <span className="text-green-600">{orderId}</span>
                    </h2>

                    {/* Shrnut√≠ produkt≈Ø */}
                    <div className="space-y-4 border-b pb-6">
                        <h3 className="text-lg font-medium">Polo≈æky</h3>
                        {order.items.map(item => {
                            const product = PRODUCT_DATA[item.id];
                            return (
                                <div key={item.id} className="flex items-center gap-4">
                                    <ImageWithFallback
                                        src={product.images[0]}
                                        alt={product.name}
                                        className="h-16 w-16 rounded-md object-cover border"
                                    />
                                    <div className="flex-1 text-sm">
                                        <div className="font-medium">{product.name}</div>
                                        <div className="text-gray-600">Mno≈æstv√≠: {item.quantity}</div>
                                    </div>
                                    <div className="text-sm font-semibold">{item.quantity * product.price} Kƒç</div>
                                </div>
                            );
                        })}
                    </div>

                    {/* Ceny */}
                    <div className="space-y-3 border-b pb-6">
                         <div className="flex justify-between text-gray-700">
                            <span>Mezisouƒçet:</span>
                            <span>{order.subtotal} Kƒç</span>
                        </div>
                        <div className="flex justify-between text-gray-700">
                            <span>Doprava ({shippingOption?.name || 'N/A'}):</span>
                            <span className="font-medium">{order.shippingCost === 0 ? 'ZDARMA' : `${order.shippingCost} Kƒç`}</span>
                        </div>
                        <div className="flex justify-between text-xl font-bold">
                            <span>Celkem zaplaceno:</span>
                            <span>{order.total} Kƒç</span>
                        </div>
                    </div>

                    {/* Doruƒçovac√≠ √∫daje */}
                    <div className="space-y-4">
                        <h3 className="text-lg font-medium">Doruƒçovac√≠ √∫daje</h3>
                        <div className="text-gray-700">
                            <p><strong>E-mail:</strong> {contact.email}</p>
                            <p><strong>Telefon:</strong> {contact.phone}</p>
                        </div>
                        {isAddressDelivery ? (
                            <div className="text-gray-700">
                                <p className="font-medium">Doruƒçen√≠ na adresu:</p>
                                <p>{contact.address.street} {contact.address.number}</p>
                                <p>{contact.address.zip} {contact.address.city}</p>
                            </div>
                        ) : (
                             // *** UPRAVENO: Zobrazen√≠ detail≈Ø z objektu m√≠sta ***
                             <div className="text-gray-700">
                                <p className="font-medium">Vyzvednut√≠ na m√≠stƒõ:</p>
                                <p><strong>{pickupPoint?.name}</strong></p>
                                <p>{pickupPoint?.street}</p>
                                <p>{pickupPoint?.zip} {pickupPoint?.city}</p>
                            </div>
                        )}
                    </div>

                    {/* Tlaƒç√≠tko zpƒõt dom≈Ø */}
                    <div className="pt-6 text-center">
                        <Button size="lg" onClick={() => navigateTo('home')}>
                            Zpƒõt na domovskou str√°nku
                        </Button>
                    </div>
                </div>
            </section>
        </React.Fragment>
    );
};


// Str√°nka Kontaktu
const ContactPage = () => {
  const { navigateTo, showToast } = useAppContext();
  
  const handleSubmit = (e) => {
    e.preventDefault();
    showToast("V√°≈° dotaz byl √∫spƒõ≈°nƒõ odesl√°n!");
  };
  
  return (
    <React.Fragment>
      <section className="bg-black text-white">
        <div className="container mx-auto max-w-7xl px-4 py-16 text-center">
          <h1 className="text-4xl font-bold tracking-tighter">Kontaktujte N√°s</h1>
          <p className="mt-4 text-lg text-gray-300">
            M√°te dotaz nebo speci√°ln√≠ po≈æadavek? R√°di v√°m pom≈Ø≈æeme!
          </p>
        </div>
      </section>
      
      <section className="container mx-auto max-w-7xl px-4 py-16 md:py-24">
        <div className="grid grid-cols-1 gap-12 md:grid-cols-2">
          {/* Formul√°≈ô */}
          <form onSubmit={handleSubmit} className="space-y-6">
            <h2 className="text-3xl font-bold">Napi≈°te n√°m</h2>
            <div className="space-y-4">
              <div>
                <Label htmlFor="name">Jm√©no</Label>
                <Input id="name" name="name" type="text" required />
              </div>
              <div>
                <Label htmlFor="email">E-mail</Label>
                <Input id="email" name="email" type="email" required />
              </div>
              <div>
                <Label htmlFor="message">Zpr√°va</Label>
                <Textarea id="message" name="message" rows={6} required />
              </div>
            </div>
            <Button type="submit" size="lg">
              Odeslat Dotaz <IconSend className="ml-2" />
            </Button>
          </form>
          
          {/* Info */}
          <div className="space-y-8">
            {/* P≈ô√≠m√© kontakty */}
            <div>
              <h3 className="text-2xl font-semibold mb-4">P≈ô√≠m√© kontakty</h3>
              <div className="flex items-center gap-4">
                <div className="flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-black text-white">
                  <IconMail size={24} />
                </div>
                <div>
                  <Label>E-mail</Label>
                  <a href="mailto:sf.simonflorian@gmail.com" className="block text-lg font-medium text-black hover:underline">
                    sf.simonflorian@gmail.com
                  </a>
                </div>
              </div>
            </div>
            
            {/* FAQ */}
            <div className="rounded-lg bg-gray-50/70 p-6">
              <h3 className="text-2xl font-semibold mb-4">ƒåasto kladen√© dotazy</h3>
              <div className="space-y-4">
                <div>
                  <h4 className="font-medium">Jak dlouho trv√° dod√°n√≠?</h4>
                  <p className="text-gray-700">Objedn√°vky odes√≠l√°me obvykle do 24 hodin. Dod√°n√≠ pak trv√° 1-3 pracovn√≠ dny.</p>
                </div>
                <div>
                  <h4 className="font-medium">Mohu vr√°tit zbo≈æ√≠?</h4>
                  <p className="text-gray-700">Ano, na vr√°cen√≠ zbo≈æ√≠ bez ud√°n√≠ d≈Øvodu m√°te 30 dn√≠.</p>
                </div>
                <div>
                  <h4 className="font-medium">Vyr√°b√≠te i jin√© motivy?</h4>
                  <p className="text-gray-700">M√°me v pl√°nu roz≈°i≈ôovat kolekci. Pro speci√°ln√≠ po≈æadavky n√°m napi≈°te!</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      
      {/* CTA sekce */}
      <section className="bg-gray-50/70 py-16 md:py-24">
        <div className="container mx-auto max-w-3xl px-4 text-center">
          <h2 className="text-3xl font-bold tracking-tighter md:text-4xl">M√°te z√°jem o na≈°e produkty?</h2>
          <p className="mt-4 text-lg text-gray-600">
            Prohl√©dnƒõte si na≈°i kompletn√≠ kolekci 3D ti≈°tƒõn√Ωch p≈ô√≠vƒõsk≈Ø.
          </p>
          <Button size="lg" className="mt-8" onClick={() => navigateTo('product', 'fox')}>
            Prozkoumat Kolekci
          </Button>
        </div>
      </section>
    </React.Fragment>
  );
};

// Str√°nka o 3D tisku
const PrintingInfoPage = () => {
  const { navigateTo } = useAppContext();
  
  return (
    <React.Fragment>
      <section className="bg-black text-white">
        <div className="container mx-auto max-w-7xl px-4 py-16 text-center">
          <div className="mx-auto flex h-20 w-20 items-center justify-center rounded-full bg-white text-black">
            <IconPrinter size={40} />
          </div>
          <h1 className="mt-6 text-4xl font-bold tracking-tighter">Jak 3D Tisk Funguje</h1>
          <p className="mt-4 text-lg text-gray-300">
            Modern√≠ technologie, kter√° vyr√°b√≠ na≈°e p≈ô√≠vƒõsky s neuvƒõ≈ôitelnou p≈ôesnost√≠.
          </p>
        </div>
      </section>
      
      {/* Co je 3D tisk */}
      <section className="container mx-auto max-w-7xl px-4 py-16 md:py-24">
        <div className="mx-auto max-w-3xl text-center">
          <h2 className="text-3xl font-bold tracking-tighter md:text-4xl">Co je 3D Tisk?</h2>
          <p className="mt-4 text-lg text-gray-600">
            3D tisk, zn√°m√Ω tak√© jako aditivn√≠ v√Ωroba, je proces vytv√°≈ôen√≠ trojrozmƒõrn√Ωch objekt≈Ø z digit√°ln√≠ho souboru. Na rozd√≠l od tradiƒçn√≠ch metod, kde se materi√°l odeb√≠r√°, 3D tisk stav√≠ objekt vrstvu po vrstvƒõ.
          </p>
        </div>
        <div className="mt-12 grid grid-cols-1 gap-8 md:grid-cols-3">
          <div className="rounded-lg bg-gray-50/70 p-6 text-center">
            <div className="mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-black text-white">
              <IconLayers size={28} />
            </div>
            <h3 className="mt-4 text-xl font-semibold">Vrstven√≠ po vrstv√°ch</h3>
            <p className="mt-2 text-gray-600">P≈ôesnost a≈æ 0,1 mm na vrstvu pro dokonal√© detaily.</p>
          </div>
          <div className="rounded-lg bg-gray-50/70 p-6 text-center">
            <div className="mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-black text-white">
              <IconZap size={28} />
            </div>
            <h3 className="mt-4 text-xl font-semibold">Rychl√° v√Ωroba</h3>
            <p className="mt-2 text-gray-600">Jeden p≈ô√≠vƒõsek je hotov√Ω p≈ôibli≈ænƒõ za 15-30 minut.</p>
          </div>
          <div className="rounded-lg bg-gray-50/70 p-6 text-center">
            <div className="mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-black text-white">
              <IconLeaf size={28} />
            </div>
            <h3 className="mt-4 text-xl font-semibold">Ekologick√Ω PLA</h3>
            <p className="mt-2 text-gray-600">Biologicky odbourateln√Ω bioplast z kuku≈ôice.</p>
          </div>
        </div>
      </section>

      {/* Proces v√Ωroby */}
      <section className="bg-gray-50/70 py-16 md:py-24">
        <div className="container mx-auto max-w-7xl px-4">
          <div className="mx-auto max-w-3xl text-center">
            <h2 className="text-3xl font-bold tracking-tighter md:text-4xl">Proces V√Ωroby</h2>
            <p className="mt-4 text-lg text-gray-600">Od digit√°ln√≠ho modelu k fyzick√©mu p≈ô√≠vƒõsku.</p>
          </div>
          <div className="mt-12 grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-4">
            <Card>
              <CardHeader><CardTitle>01 - 3D Model</CardTitle></CardHeader>
              <CardContent><p className="text-sm text-gray-700">Vytvo≈ô√≠me digit√°ln√≠ model v softwaru (Fusion 360, Blender).</p></CardContent>
            </Card>
            <Card>
              <CardHeader><CardTitle>02 - Slicov√°n√≠</CardTitle></CardHeader>
              <CardContent><p className="text-sm text-gray-700">Model je "nakr√°jen" na vrstvy v Bambu Studio.</p></CardContent>
            </Card>
            <Card>
              <CardHeader><CardTitle>03 - 3D Tisk</CardTitle></CardHeader>
              <CardContent><p className="text-sm text-gray-700">Tisk√°rna tav√≠ PLA filament a nan√°≈°√≠ vrstvu po vrstvƒõ.</p></CardContent>
            </Card>
            <Card>
              <CardHeader><CardTitle>04 - Dokonƒçen√≠</CardTitle></CardHeader>
              <CardContent><p className="text-sm text-gray-700">Ka≈æd√° vrstva chladne, tuhne a p≈ô√≠vƒõsek je hotov.</p></CardContent>
            </Card>
          </div>
        </div>
      </section>
      
      {/* Tisk√°rna */}
      <section className="container mx-auto max-w-7xl px-4 py-16 md:py-24">
        <div className="grid grid-cols-1 items-center gap-12 md:grid-cols-2">
          <div>
            <h2 className="text-3xl font-bold tracking-tighter md:text-4xl">Tisk√°rna Bambu Lab P1S</h2>
            <p className="mt-4 text-lg text-gray-600">
              Pro na≈°e produkty spol√©h√°me na profesion√°ln√≠ tisk√°rnu Bambu Lab P1S, kter√° je ≈°piƒçkou v oboru. Zaruƒçuje neuvƒõ≈ôitelnou rychlost, spolehlivost a d√≠ky AMS syst√©mu i perfektn√≠ v√≠cebarevn√Ω tisk.
            </p>
            <Card className="mt-6 bg-gray-50/70">
              <CardHeader><CardTitle>Technick√© specifikace</CardTitle></CardHeader>
              <CardContent className="space-y-2 text-sm">
                {[
                  "Tisk√°rna: Bambu Lab P1S",
                  "P≈ôesnost vrstvy: 0,05 - 0,35 mm",
                  "Rychlost tisku: a≈æ 500 mm/s",
                  "V√≠cebarevn√Ω tisk: Ano (s AMS)"
                ].map(item => (
                  <div key={item} className="flex items-center gap-2">
                    <IconCheck className="text-green-600" />
                    <span>{item}</span>
                  </div>
                ))}
              </CardContent>
            </Card>
          </div>
          <div className="grid grid-cols-1 gap-4 sm:grid-cols-2">
            <ImageWithFallback src={IMAGES.printer_image} alt="Tisk√°rna Bambu Lab P1S" className="aspect-video w-full rounded-lg object-cover shadow-md" />
            <ImageWithFallback src={IMAGES.filament_image} alt="Barevn√© PLA filamenty" className="aspect-video w-full rounded-lg object-cover shadow-md" />
          </div>
        </div>
      </section>

      {/* Proƒç PLA */}
      <section className="bg-black text-white">
        <div className="container mx-auto max-w-5xl px-4 py-16 md:py-24 text-center">
          <div className="mx-auto flex h-20 w-20 items-center justify-center rounded-full bg-white text-black">
            <IconLeaf size={40} />
          </div>
          <h2 className="mt-6 text-3xl font-bold tracking-tighter md:text-4xl">Proƒç PLA Filament?</h2>
          <p className="mt-4 text-lg text-gray-300">
            PLA je ekologick√Ω bioplast vyroben√Ω z obnoviteln√Ωch zdroj≈Ø, jako je kuku≈ôice nebo cukrov√° t≈ôtina. Je biologicky odbourateln√Ω, netoxick√Ω a bez z√°pachu p≈ôi tisku.
          </p>
          <p className="mt-4 text-lg text-gray-300">
            Z√°rove≈à je pevn√Ω, lehk√Ω a nab√≠z√≠ ≈æiv√©, syt√© barvy, co≈æ z nƒõj ƒçin√≠ ide√°ln√≠ materi√°l pro detailn√≠ p≈ô√≠vƒõsky.
          </p>
        </div>
      </section>

      {/* CTA */}
      <section className="py-16 md:py-24">
        <div className="container mx-auto max-w-3xl px-4 text-center">
          <h2 className="text-3xl font-bold tracking-tighter md:text-4xl">P≈ôesvƒõdƒçte se sami o kvalitƒõ 3D tisku</h2>
          <p className="mt-4 text-lg text-gray-600">
            Ka≈æd√Ω p≈ô√≠vƒõsek je vyroben s maxim√°ln√≠ p√©ƒç√≠ o detail.
          </p>
          <Button size="lg" className="mt-8" onClick={() => navigateTo('product', 'fox')}>
            Prozkoumat Kolekci
          </Button>
        </div>
      </section>
    </React.Fragment>
  );
};


// --- HLAVN√ç KOMPONENTA APLIKACE ---

function App() {
  return (
    <AppProvider>
      <div className="flex min-h-screen flex-col bg-white text-black">
        <Header />
        
        <main className="flex-grow">
          <PageContent />
        </main>
        
        <Footer />
        <Toast />
      </div>
    </AppProvider>
  );
}

// Router
const PageContent = () => {
  const { currentPage } = useAppContext();
  
  switch (currentPage) {
    case 'home':
      return <HomePage />;
    case 'product':
      return <ProductDetailPage />;
    case 'cart':
      return <CartPage />;
    case 'checkout':
      return <CheckoutPage />;
    case 'confirmation':
      return <ConfirmationPage />;
    case 'contact':
      return <ContactPage />;
    case 'printing':
      return <PrintingInfoPage />;
    default:
      return <HomePage />;
  }
};

// --- RENDER APLIKACE ---
const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<App />);

    </script>
</body>
</html>